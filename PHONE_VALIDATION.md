# 📞 Store Phone 驗證規則

## ✅ 允許的字元

Store 的 phone 欄位只允許以下字元：

| 字元 | 說明 | 範例 |
|------|------|------|
| **數字** | 0-9 | `555`, `1234` |
| **+** | 國際碼前綴 | `+1`, `+886` |
| **-** | 連字號分隔 | `555-1234` |
| **()** | 括號區域碼 | `(02)`, `(555)` |
| **#** | 分機號碼 | `#123`, `#456` |
| **空格** | 數字分隔 | `555 1234` |

---

## 📝 驗證規則

```php
TextInput::make('phone')
    ->tel()
    ->required()
    ->maxLength(255)
    ->regex('/^[\d+\-()#\s]+$/')
    ->validationMessages([
        'regex' => 'Phone number can only contain numbers, +, -, (), # and spaces.',
    ]);
```

### 正則表達式說明

`/^[\d+\-()#\s]+$/`

- `^` - 字串開始
- `[...]` - 字元集合
  - `\d` - 數字 0-9
  - `+` - 加號
  - `\-` - 連字號（需要跳脫）
  - `()` - 左右括號
  - `#` - 井號
  - `\s` - 空格
- `+` - 一個或多個
- `$` - 字串結束

---

## ✅ 有效的電話格式

```
+1 (555) 123-4567
+886-2-2345-6789
(02) 1234-5678
555-1234
+1-555-123-4567 #123
(555) 123 4567
+886 912 345 678
02-2345-6789
```

---

## ❌ 無效的電話格式

| 輸入 | 原因 |
|------|------|
| `555.1234` | 包含點號 (.) |
| `555/1234` | 包含斜線 (/) |
| `555*1234` | 包含星號 (*) |
| `555@1234` | 包含 @ 符號 |
| `abc-1234` | 包含英文字母 |
| `555_1234` | 包含底線 (_) |
| `555,1234` | 包含逗號 (,) |

---

## 🧪 測試範例

### 測試 1: 美國電話格式
```
輸入: +1 (555) 123-4567
結果: ✅ 有效
說明: 包含國際碼、區域碼、連字號
```

### 測試 2: 台灣手機格式
```
輸入: +886 912 345 678
結果: ✅ 有效
說明: 包含國際碼、空格分隔
```

### 測試 3: 辦公室電話 + 分機
```
輸入: (02) 2345-6789 #123
結果: ✅ 有效
說明: 包含區域碼、連字號、分機號
```

### 測試 4: 簡單格式
```
輸入: 555-1234
結果: ✅ 有效
說明: 基本格式
```

### 測試 5: 錯誤格式 - 點號
```
輸入: 555.123.4567
結果: ❌ 無效
錯誤: Phone number can only contain numbers, +, -, (), # and spaces.
```

### 測試 6: 錯誤格式 - 字母
```
輸入: call-me-1234
結果: ❌ 無效
錯誤: Phone number can only contain numbers, +, -, (), # and spaces.
```

---

## 🎯 實際應用

### Seed 資料中的電話格式

```php
// StoreSeeder.php
$stores = [
    [
        'phone' => '+1 (555) 100-0001',  // ✅ 有效
    ],
    [
        'phone' => '+1 (555) 200-0002',  // ✅ 有效
    ],
];
```

所有 seed 資料中的電話格式都符合驗證規則！

---

## 📋 在 Filament 中的顯示

### Form 輸入
```php
// 用戶輸入
Input: +1 (555) 123-4567

// 驗證通過
✅ Saved successfully
```

### 錯誤訊息
```php
// 用戶輸入
Input: 555.123.4567

// 顯示錯誤
❌ Phone number can only contain numbers, +, -, (), # and spaces.
```

---

## 🔧 如何測試

### 後台測試

1. 登入 Admin Panel
   ```
   http://localhost:8000/backend
   ```

2. 前往 Stores → Create

3. 測試各種電話格式：
   - ✅ `+1 (555) 123-4567`
   - ✅ `555-1234`
   - ✅ `(02) 2345-6789 #123`
   - ❌ `555.123.4567`
   - ❌ `call-me-now`

4. 查看驗證結果

---

## 💡 擴展建議

### 如果需要更嚴格的驗證

可以添加特定國家的格式驗證：

```php
// 台灣手機格式
->regex('/^(\+886|0)9\d{8}$/')

// 台灣市話格式
->regex('/^0\d{1,2}-\d{7,8}$/')

// 美國電話格式
->regex('/^\+1\s?\(\d{3}\)\s?\d{3}-\d{4}$/')
```

### 如果需要更寬鬆的驗證

```php
// 允許更多字元
->regex('/^[\d+\-()#\s.,*]+$/')
```

---

## ✅ 完成

Store phone 欄位現在已經加入驗證規則：
- ✅ 只允許數字、+、-、()、# 和空格
- ✅ 顯示友善的錯誤訊息
- ✅ 所有現有 seed 資料都符合規則

**立即測試:** http://localhost:8000/backend/stores/create 🎯


